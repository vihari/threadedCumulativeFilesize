#include <pthread.h>
#include <semaphore.h>

/* Individual job */
typedef struct thpool_job_t{
  void*  (*function)(void* arg);                     /* function pointer         */
  void*                     arg;                     /* function's argument      */
  struct thpool_job_t*     next;                     /* pointer to next job      */
  struct thpool_job_t*     prev;                     /* pointer to previous job  */
}thpool_job_t;


/* Job queue as doubly linked list */
typedef struct thpool_jobqueue{
  thpool_job_t *head;                                /* pointer to head of queue */
  thpool_job_t *tail;                                /* pointer to tail of queue */
  int           jobsN;                               /* amount of jobs in queue  */
  sem_t        *queueSem;                            /* semaphore(this is probably just holding the same as jobsN) */
}thpool_jobqueue;


/* The threadpool */
typedef struct thpool_t{
  pthread_t*       threads;                          /* pointer to threads' ID   */
  int              threadsN;                         /* amount of threads        */
  thpool_jobqueue* jobqueue;                         /* pointer to the job queue */
}thpool_t;


/* Container for all things that each thread is going to need */
typedef struct thread_data{                            
  pthread_mutex_t *mutex_p;
  thpool_t        *tp_p;
}thread_data;
